%画折线图
%x=-15:-1:-40;
%a=[1,1,1,1,1,1,1,1,1,1,...
%   1,0.98,0.89,0.76,0.59,0.47,0.30,0.17,0.10,0.06,...
%   0.02,0,0,0,0,0];
%b=[1,1,1,1,1,1,1,1,1,1,...
%   1,1,1,1,0.98,0.94,0.89,0.82,0.75,0.62,...
%   0.44,0.22,0.12,0.06,0.02,0];

%values = spcrv([[x(1) x x(end)];[a(1) a a(end)]],3);
%values1 = spcrv([[x(1) x x(end)];[b(1) b b(end)]],3);
%figure(1)
%plot(values(1,:),values(2,:), 'g');
%hold on
%plot(values1(1,:),values1(2,:));
%set(gca,'Xdir','reverse');
%xlabel('信噪比/dB');
%ylabel('捕获正确率');
%title('仿真结果统计');
%legend('改进前的算法','改进后的算法');

y=-25:-0.2:-40;
c=[1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,0.99,0.97,0.94,0.88,...
   0.8,0.71,0.6,0.48,0.35,...
   0.21,0.15,0.1,0.05,0.02,...
   0,0,0,0,0,...
   0,0,0,0,0,...
   0,0,0,0,0,...
   0,0,0,0,0,0];
d=[1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,1,...
   1,1,1,1,0.96,...
   0.82,0.65,0.5,0.32,0.21,...
   0.1,0.02,0,0,0,...
   0,0,0,0,0,...
   0,0,0,0,0,0];
figure(2)
plot(y,c,y,d,'r');
set(gca,'Xdir','reverse');
xlabel('信噪比/dB');
ylabel('捕获正确率');
title('捕获正确率与输入信号信噪比的关系');
legend('改进前的算法','改进后的算法');

%用于验证积分累加模块的FPGA实现
load('C_2D.mat')
data = ([C_2D 2000*ones(1,360)]);
accumu = zeros(1,8192);

for i=1:8192
    temp = 0;
    for j = 1:45
       temp = temp + data(j+(i-1)*45);
    end
   accumu(i) = ceil(temp/45);
end

figure(3)
plot(accumu);


fidI = fopen('D:\My_project\project_13\data.txt','wt');
fprintf(fidI,'%x\n',accumu);
fclose(fidI);


